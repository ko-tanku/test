<<<<<<< HEAD
# Core機能 拡張・改善計画書 (2025年8月26日版)

## 1. はじめに

このドキュメントは、現在のプロジェクト進捗状況と学習者の理想的体験要件を踏まえ、`src/core`機能を**単なる教材生成ツールから学習効果を最大化する包括的な教育プラットフォーム**へと進化させるための拡張・改善計画書です。

### 1.1 ドキュメントの位置づけ
- **現状把握**: 基盤安定化（フェーズ1）が完了し、実装可能な基盤が整備済み
- **目標設定**: 30種類以上の多様な教材に対応可能なスケーラブルなプラットフォーム実現
- **戦略**: 段階的改善により、現在のアーキテクチャを活かした機能拡張

### 1.2 改善計画の分類
1.  **既存機能の改善・正常化** - 現在実装済みだが改善が必要な機能
2.  **学習体験向上機能** - 学習者の体験を向上させる新機能
3.  **プラットフォーム機能** - 複数教材を統合管理する機能
4.  **開発・運用支援機能** - 開発効率と品質を向上させる機能
=======
# Core機能 拡張・改善リスト

## 1. はじめに

このドキュメントは、「学習資料要件」で定義された理想の学習資料を実現するために、現在の`src/core`機能では不足している、あるいは改善が必要な機能をリストアップしたものです。

本文書は、以下の2つのカテゴリに分かれています。

1.  **既存機能の改善・正常化:** `core`に機能の雛形は存在するものの、不完全または正常に動作していないもの。
2.  **新規機能拡張:** `core`に存在しない、新たに追加が必要な機能。
>>>>>>> dbde2096846e5b4398413351225cc5f784d336f1

---

## 2. 既存機能の改善・正常化

`CLAUDE.md`の未解決問題リストに基づき、以下の機能は正常な動作のために改善が必要です。

### 2.1. Mermaid.jsの表示機能

- **現状:** `DocumentBuilder`に`add_mermaid_block`メソッドは存在するが、実際には図としてレンダリングされず、コードブロックのまま表示される。
- **必要な改善:** `mkdocs-mermaid2-plugin`の初期化プロセスや、JavaScriptライブラリの読み込み順序などを詳細に調査し、Mermaid構文が正しく図に変換されるように修正する。`custom_fences`の設定だけでは不十分な、根本的な原因の解決が必要。

### 2.2. インタラクティブクイズ機能

- **現状:** `DocumentBuilder`に各種クイズ（単一選択、複数選択、カテゴリ分け）を生成するメソッドは存在するが、特に単一選択クイズが正常に動作しない。
- **必要な改善:** クイズのHTMLを生成するロジックと、その動作を制御するJavaScript（`quiz.js`など）、そしてデータソースであるYAMLファイル（`quizzes.yml`）の三者間で、データ構造やIDの受け渡しに不整合がないかを確認し、修正する。全てのクイズタイプが設計通りに動作するようにデバッグを行う。

### 2.3. 図表の表示問題

- **現状:** 3章の図表が表示されず、2章のテーブルは表示範囲が狭すぎる問題が報告されている。
- **必要な改善:** `ChartGenerator`や`TableGenerator`のHTML/CSS生成ロジックを見直し、データソース（CSV/YAML）のパス解決や、生成されるHTML/CSSに問題がないかを確認する。特に、テーブルのレスポンシブ対応や、iframeの高さ自動調整などのCSS/JSの挙動を再検証する。

---

## 3. 新規機能拡張

`IMPROVEMENT_PROPOSALS.md`で提案されている高度な機能を実現するため、以下の新規機能が必要です。

### 3.1. プラットフォーム機能

#### 3.1.1. 複数教材の連携
- **現状の限界:** 現在の`core`機能は、単一の教材（例: `test_material`）内での動作を前提としており、他の教材と連携する仕組みがない。
- **拡張内容:**
    - **総合用語集:** 複数の`materials`ディレクトリを横断的にスキャンし、全ての用語を集約して単一の用語集ページを生成する新しいスクリプトまたは`KnowledgeManager`の拡張機能。
    - **ラーニングパス:** 教材間の依存関係（前提知識、推奨次教材）を定義・解析し、サイトのトップページなどに可視化する機能。
    - **横断検索の補助:** 複数の教材をまたいだ検索結果を、JavaScriptで加工して教材名ラベルを付与するなど、UXを向上させる仕組み。

#### 3.1.2. 学習オブジェクトによるコンテンツ再利用
- **現状の限界:** コンテンツは章ごとのYAMLファイルに記述されており、章をまたいだコンテンツの再利用が考慮されていない。
- **拡張内容:**
    - `src/learning_objects`のような共通ディレクトリを新設。
    - `ContentManager`を拡張し、章のYAMLファイルから`object_id`のような参照を検知し、対応する学習オブジェクトのYAMLファイルをその場に展開してレンダリングする機能。

<<<<<<< HEAD
### 3.2. 学習体験向上機能

#### 3.2.1. AI搭載型学習進度パーソナライゼーション機能
- **現状の限界:** すべての学習者に同一のコンテンツが提供され、個人の学習ペースや理解度に応じた最適化が行われていない。
- **拡張内容:**
    - **学習進度トラッキング:** 各章の滞在時間、クイズ正答率、ページ遷移パターンをJavaScriptで取得・蓄積する機能を`DocumentBuilder`に追加。
    - **適応的コンテンツ推奨:** 学習者の理解度に基づき、次に学ぶべき章や復習すべき内容を動的に提案するアルゴリズムを`KnowledgeManager`に実装。
    - **学習困難箇所の自動検出:** クイズの間違いパターンから学習者が苦手とする概念を特定し、補強コンテンツを自動提示する機能。

#### 3.2.2. マルチメディア学習支援
- **現状の限界:** テキストと基本図表のみで、多様な学習スタイルに対応した教材提供ができていない。
- **拡張内容:**
    - **動的アニメーション機能:** JavaScriptを活用した概念説明アニメーション（例：制御システムの状態遷移、信号処理のフローなど）を生成する`AnimationGenerator`クラスを新設。
    - **インタラクティブシミュレーション:** 学習者が実際にパラメーターを変更して結果を確認できるシミュレーション環境（例：PID制御パラメーター調整など）。
    - **音声による解説機能:** テキストから音声を生成し、学習者がハンズフリーで学習を進められる機能。

### 3.3. プラットフォーム機能拡張

#### 3.3.1. 複数教材統合学習環境
- **現状:** 前述の通り。
- **拡張内容:**
    - **総合用語集:** 前述の通り。
    - **ラーニングパス:** 前述の通り。
    - **横断検索の補助:** 前述の通り。
    - **学習履歴の統合管理:** 複数教材間での学習進度・成績を一元管理し、全体的な習熟度を可視化する機能。

#### 3.3.2. コラボレーション機能
- **現状の限界:** 個別学習のみで、学習者同士の協働や教員との相互作用機能が不足している。
- **拡張内容:**
    - **学習者コミュニティ機能:** 各章にディスカッションエリアを設け、学習者同士が質問・回答を共有できる仕組み。
    - **グループ学習支援:** チーム課題の進度管理、メンバー間の進捗共有機能。
    - **教員ダッシュボード:** 学習者の進度・理解度を教員が一覧できる管理画面。

### 3.4. 開発・運用支援機能

#### 3.4.1. 自動テストスイートの導入
- **現状の限界:** 前述の通り。
- **拡張内容:**
    - **pytest導入:** 前述の通り。
    - **自動テスト整備:** 前述の通り。
    - **継続的インテグレーション:** GitHub ActionsやJenkinsと連携した自動テスト・デプロイパイプラインの構築。



## 5. 技術的実装戦略

### 5.1. アーキテクチャ拡張方針
- **現行の`src/core`構造を基盤として活用**し、新機能は新規クラスとして追加
- **段階的移行**により既存教材への影響を最小化
- **モジュラー設計**により、不要な機能は無効化可能な構造を維持

### 5.2. データ管理戦略
- **YAMLベースのコンテンツ管理**を継続しつつ、メタデータ拡張で新機能をサポート
- **学習履歴・分析データ**は軽量データベース（SQLite等）での管理を検討
- **プライバシー保護**を徹底し、学習者データの適切な匿名化・暗号化を実装

### 5.3. 互換性保証
- **既存教材**は無変更で動作継続を保証
- **新機能**はオプトイン形式で導入し、段階的な移行を支援
- **API設計**において後方互換性を重視した拡張性を確保
=======
#### 3.1.3. 学習者からのフィードバック機能
- **現状の限界:** 学習者からのフィードバックを収集する標準的な仕組みがない。
- **拡張内容:**
    - `DocumentBuilder`に`add_feedback_form(form_url: str)`のようなメソッドを追加。Google FormsなどのURLを渡すだけで、定型的なフィードバックフォームのHTMLを簡単に埋め込めるようにする。

### 3.2. 開発・品質保証

#### 3.2.1. 自動テストスイートの導入
- **現状の限界:** プロジェクトに自動テストが存在せず、機能追加やリファクタリングが安全に行えない。
- **拡張内容:**
    - `pytest`を開発依存関係に追加。
    - `tests/`ディレクトリを新設し、`core`の各機能（`ChartGenerator`など）に対するユニットテストを整備。
    - 教材が正しく生成されるかを確認する統合テストを整備。
>>>>>>> dbde2096846e5b4398413351225cc5f784d336f1
